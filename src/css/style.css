@import "tailwindcss";

:root {
 --bg-dark: rgba(15,20,30,0.7);
 --bg-darker: rgba(10,15,22,0.8);
 --bg-light: rgba(25,32,45,0.6);
 --accent-primary: #4a9eff;
 --text-primary: #ffffff;
 --text-secondary: #b4bcc9;
 --text-muted: #6c7a89;
 --border: rgba(255,255,255,0.08);
 --border-hover: rgba(74,158,255,0.3);
 --gap-xs:2px;
 --gap-sm:4px;
 --gap-md:6px;
 --gap-lg:8px;
 --gap-xl:12px;
 --radius:6px;
 --radius-sm:3px;
 --transition:0.2s ease;
 --scale:1;
 --content-opacity:1;
}

.dps-meter {
 position: relative;
}

.dps-bg {
 position: absolute;
 inset:0;
 background: var(--bg-dark);
 border-radius: inherit;
 z-index:0;
 pointer-events: none;
 opacity: var(--content-opacity);
 transition: opacity0.15s ease;
 backdrop-filter: blur(8px);
 border:1px solid rgba(255,255,255,0.02);
}

.dps-meter > :not(.controls):not(.dps-bg) {
 opacity: var(--content-opacity);
 transition: opacity0.15s ease;
 z-index:1;
}

.controls {
 opacity:1;
 position: relative;
 z-index:2;
}

html {
 width: fit-content;
}

body {
 font-family: Inter, sans-serif;
 background: transparent;
 color: var(--text-primary);
 overflow: hidden;
 line-height:1.5;
 margin:0;
 padding:0;
 width:100%;
 height:100%;
 pointer-events: none;
 zoom: var(--scale);
}

.dps-meter {
 width: fit-content;
 height: fit-content;
 min-width:300px;
 min-height:0;
 background: var(--bg-dark);
 backdrop-filter: blur(8px);
 padding:1px;
 display: flex;
 flex-direction: column;
 gap:1px;
 border-radius: var(--radius);
 pointer-events: none;
 position: relative;
}

.controls {
 display: flex;
 align-items: center;
 padding: var(--gap-xs);
 background: var(--bg-darker);
 border-radius: var(--radius);
 border:1px solid var(--border);
 pointer-events: all;
 flex-shrink:0;
 position: relative;
 z-index:2;
 -webkit-app-region: no-drag; /* drag handled by grip only */
}

.control-button {
 min-width:20px;
 height:20px;
 background: rgba(255,255,255,0.05);
 border:1px solid var(--border);
 border-radius: var(--radius-sm);
 color: var(--text-secondary);
 cursor: pointer;
 display: flex;
 align-items: center;
 justify-content: center;
 transition: all var(--transition);
 font-size:10px;
 pointer-events: auto;
 -webkit-app-region: no-drag;
}

.control-button:hover {
 background: var(--accent-primary);
 color: var(--text-primary);
 border-color: var(--accent-primary);
}

/* Botones de ordenamiento */
.sort-button {
 min-width:20px;
 height:20px;
 padding:4px10px;
 background: rgba(255,255,255,0.05);
 border:1px solid var(--border);
 border-radius: var(--radius-sm);
 color: var(--text-secondary);
 cursor: pointer;
 font-size:10px;
 font-weight:600;
 text-transform: uppercase;
 transition: all var(--transition);
 pointer-events: auto;
 display: flex;
 align-items: center;
 justify-content: center;
 -webkit-app-region: no-drag;
}

.sort-button:hover {
 background: rgba(74,158,255,0.15);
 color: var(--accent-primary);
 border-color: var(--border-hover);
}

.sort-button.active {
 background: var(--accent-primary);
 color: var(--text-primary);
 border-color: var(--accent-primary);
 box-shadow:008px rgba(74,158,255,0.3);
}

/* Estados del candado */
.dps-meter.locked .close-button {
 opacity:0.3;
 cursor: not-allowed;
 pointer-events: none;
}

.advanced-lite-btn {
 width: auto;
 padding:06px;
 font-size:9px;
 font-weight:600;
 text-transform: uppercase;
}

.advanced-lite-btn.group {
 background: rgba(74,158,255,0.2);
 color: var(--accent-primary);
 border-color: var(--accent-primary);
}

.drag-indicator {
 width:20px;
 height:24px;
 display: flex;
 align-items: center;
 justify-content: center;
 color: var(--text-muted);
 pointer-events: auto;
 user-select: none;
 -webkit-app-region: drag;
 cursor: move;
}

.dps-meter.locked .drag-indicator {
 opacity:0.3;
 cursor: not-allowed;
 pointer-events: none;
}

.drag-indicator:hover {
 color: var(--accent-primary);
}

.sync-button {
 width:20px;
 height:20px;
 background: rgba(255,255,255,0.05);
 border:1px solid var(--border);
 border-radius: var(--radius-sm);
 display: flex;
 align-items: center;
 justify-content: center;
 cursor: pointer;
 transition: all var(--transition);
 color: var(--text-secondary);
 font-size:10px;
 pointer-events: auto;
 -webkit-app-region: no-drag;
}

.sync-button:hover {
 background: var(--accent-primary);
 color: var(--text-primary);
 border-color: var(--accent-primary);
}

.sync-button:hover .sync-icon {
 color: var(--text-primary);
}

#loading-indicator {
 text-align: center;
 padding: var(--gap-sm);
 color: var(--accent-primary);
 font-size:12px;
 transform: translateY(-2px);
 flex-shrink:0;
}

#player-bars-container {
 display: flex;
 flex-direction: column;
 gap: var(--gap-xs);
 pointer-events: none;
 flex:1;
 overflow-y: auto;
 overflow-x: hidden;
 min-height:0;
}

.player-bar {
 background: var(--bg-light);
 border:1px solid var(--border);
 border-radius: var(--radius);
 padding: var(--gap-xs);
 position: relative;
 overflow: visible;
 transition: all0.3s ease;
 pointer-events: auto;
 cursor: default;
}

.player-bar:hover {
 border-color: var(--border-hover);
 background: rgba(25,32,45,0.5);
 transform: translateX(2px);
}

.player-bar::before {
 content: "";
 position: absolute;
 top:0;
 left:0;
 height:100%;
 width: var(--damage-percent);
 background: var(--damage-bg-color);
 transition: width0.3s ease;
 z-index:0;
}

.player-info {
 display: flex;
 align-items: center;
 gap: var(--gap-md);
 position: relative;
 z-index:1;
}

.player-info-dps {
 justify-content: space-around;
}

.add-to-registry-btn {
 width:16px;
 height:16px;
 background: rgba(74,158,255,0.15);
 border:1px solid rgba(74,158,255,0.3);
 border-radius:50%;
 color: var(--accent-primary);
 cursor: pointer;
 display: flex;
 align-items: center;
 justify-content: center;
 font-size:8px;
 transition: all var(--transition);
 padding:0;
 flex-shrink:0;
 pointer-events: auto;
}

.add-to-registry-btn:hover {
 background: rgba(74,158,255,0.3);
 border-color: var(--accent-primary);
 transform: scale(1.1);
}

.add-to-registry-btn:active {
 transform: scale(0.95);
}

.copy-summary-btn {
 width:18px;
 height:18px;
 background: rgba(255,255,255,0.03);
 border:1px solid rgba(255,255,255,0.06);
 border-radius:4px;
 color: var(--text-secondary);
 cursor: pointer;
 display: flex;
 align-items: center;
 justify-content: center;
 font-size:10px;
 transition: all var(--transition);
 padding:04px;
 flex-shrink:0;
 pointer-events: auto;
 position: relative;
}

.copy-summary-btn:hover {
 background: rgba(74,158,255,0.12);
 color: var(--text-primary);
 border-color: var(--border-hover);
 transform: translateY(-1px);
}

.copy-summary-btn:active {
 transform: scale(0.96);
}

.copy-feedback {
 position: absolute;
 top: -22px;
 left:50%;
 transform: translateX(-50%);
 background: rgba(0,0,0,0.7);
 color: var(--text-primary);
 padding:2px6px;
 border-radius:4px;
 font-size:10px;
 white-space: nowrap;
 box-shadow:02px8px rgba(0,0,0,0.4);
 pointer-events: none;
 z-index:10;
}

.player-position {
 font-size:12px;
 font-weight:700;
 color: var(--text-primary);
 min-width:28px;
 height:28px;
 display: flex;
 align-items: center;
 justify-content: center;
 flex-shrink:0;
 border-radius:50%;
 background: rgba(255,255,255,0.08);
 border:1px solid rgba(255,255,255,0.12);
 box-shadow:02px4px rgba(0,0,0,0.2);
}

.player-position.rank-1 {
 background: linear-gradient(135deg, #ffd7000%, #ffed4e100%);
 border-color: #ffa500;
 color: #1a1a1a;
 box-shadow:
0012px rgba(255,215,0,0.4),
02px4px rgba(0,0,0,0.3);
}

.player-position.rank-2 {
 background: linear-gradient(135deg, #c0c0c00%, #e8e8e8100%);
 border-color: #a8a8a8;
 color: #1a1a1a;
 box-shadow:
0010px rgba(192,192,192,0.3),
02px4px rgba(0,0,0,0.3);
}

.player-position.rank-3 {
 background: linear-gradient(135deg, #cd7f320%, #e89b5e100%);
 border-color: #b87333;
 color: #1a1a1a;
 box-shadow:
0010px rgba(205,127,50,0.3),
02px4px rgba(0,0,0,0.3);
}

.player-position.local-player {
 background: linear-gradient(135deg, #4a9eff0%, #6bb3ff100%);
 border-color: #3b8aef;
 color: #ffffff;
 box-shadow:
0012px rgba(74,158,255,0.5),
02px4px rgba(0,0,0,0.3);
}

.player-position.rank-1.local-player {
 background: linear-gradient(135deg, #ffd7000%, #ffed4e100%);
 border:2px solid #4a9eff;
 color: #1a1a1a;
 box-shadow:
0016px rgba(74,158,255,0.8),
008px rgba(255,215,0,0.6),
02px4px rgba(0,0,0,0.3);
}

.player-position.rank-2.local-player {
 background: linear-gradient(135deg, #c0c0c00%, #e8e8e8100%);
 border:2px solid #4a9eff;
 color: #1a1a1a;
 box-shadow:
0016px rgba(74,158,255,0.8),
008px rgba(192,192,192,0.5),
02px4px rgba(0,0,0,0.3);
}

.stat-value[data-tooltip] {
 position: relative;
 cursor: help;
}

/* Device Picker styles */
.device-app {
 width:560px;
 background: linear-gradient(180deg, rgba(8,12,18,0.85), rgba(6,8,12,0.9));
 border:1px solid rgba(255,255,255,0.06);
 padding:18px;
 border-radius:10px;
 box-shadow:08px30px rgba(0,0,0,0.6), inset01px0 rgba(255,255,255,0.02);
 color: var(--text-primary);
 pointer-events: all;
 backdrop-filter: blur(6px) saturate(120%);
}

.device-app h3 {
 margin:0012px0;
 font-size:18px;
 font-weight:700;
 color: var(--text-primary);
}

.device-list {
 max-height:360px;
 overflow: auto;
 display: flex;
 flex-direction: column;
 gap:8px;
 padding-right:6px;
}

.device-item {
 display: flex;
 gap:12px;
 align-items: center;
 padding:10px12px;
 border-radius:8px;
 border:1px solid transparent;
 transition: all0.16s ease;
 cursor: pointer;
 user-select: none;
 background: rgba(255,255,255,0.01);
}

.device-item:hover {
 background: rgba(74,158,255,0.04);
 border-color: rgba(74,158,255,0.06);
}

.device-item input[type="radio"] {
 width:16px;
 height:16px;
 accent-color: var(--accent-primary);
 flex-shrink:0;
}

.device-meta {
 display: flex;
 flex-direction: column;
 gap:4px;
 min-width:0;
}

.device-name {
 font-weight:700;
 font-size:14px;
 color: var(--text-primary);
 white-space: nowrap;
 overflow: hidden;
 text-overflow: ellipsis;
}

.device-desc {
 font-size:12px;
 color: var(--text-secondary);
 opacity:0.95;
 white-space: nowrap;
 overflow: hidden;
 text-overflow: ellipsis;
}

.device-no-devices {
 padding:12px;
 color: var(--text-secondary);
 font-size:13px;
}

.device-buttons {
 display: flex;
 justify-content: flex-end;
 gap:8px;
 margin-top:14px;
}

.device-buttons .control-button {
 pointer-events: all;
 padding:6px12px;
 height: auto;
 min-width:72px;
 border-radius:6px;
 font-size:13px;
}

.device-buttons .control-button:disabled {
 opacity:0.45;
 cursor: not-allowed;
}

/* Custom scrollbar for device list */
.device-list::-webkit-scrollbar {
 width:10px;
}

.device-list::-webkit-scrollbar-track {
 background: transparent;
}

.device-list::-webkit-scrollbar-thumb {
 background: rgba(255,255,255,0.06);
 border-radius:10px;
 border:2px solid transparent;
 background-clip: padding-box;
}

@media (max-width:640px) {
 .device-app {
 width: calc(100vw -24px);
 padding:12px;
 }

 .device-list {
 max-height:320px;
 }
}

.device-app .fa-grip-vertical {
 font-size:14px;
 color: var(--text-muted);
}

.device-app .control-button {
 background: rgba(255,255,255,0.03);
 border:1px solid rgba(255,255,255,0.06);
 color: var(--text-secondary);
}

.device-app .control-button:hover {
 background: rgba(74,158,255,0.12);
 color: var(--text-primary);
 border-color: var(--border-hover);
}

.device-app .controls .drag-indicator:hover {
 color: var(--accent-primary);
}

.device-app .controls .title {
 font-weight:700;
 color: var(--text-primary);
 font-size:13px;
}

.device-app .controls .control-button {
 min-width:28px;
 height:28px;
 padding:08px;
 border-radius:6px;
 font-size:12px;
 display: inline-flex;
 align-items: center;
 justify-content: center;
}

.device-app .controls .control-button:hover {
 background: var(--accent-primary);
 color: var(--text-primary);
 border-color: var(--accent-primary);
}

.device-app .controls .close-button {
 background: rgba(255,255,255,0.03);
}

.stat-value[data-tooltip]::after {
 content: attr(data-tooltip);
 position: absolute;
 left:50%;
 bottom: calc(100% +8px);
 transform: translateX(-50%) translateY(6px);
 background: rgba(0,0,0,0.85);
 color: var(--text-primary);
 padding:6px8px;
 border-radius:6px;
 font-size:9px;
 white-space: nowrap;
 box-shadow:04px12px rgba(0,0,0,0.5);
 opacity:0;
 pointer-events: none;
 transition: opacity0.15s ease, transform0.15s ease;
 z-index:9999;
}

.stat-value[data-tooltip]:hover::after,
.stat-value[data-tooltip]:focus::after {
 opacity:1;
 transform: translateX(-50%) translateY(0);
}

.player-bar.first-player .stat-value[data-tooltip]::after {
 bottom: calc(100% -15px);
}

.player-bar {
 overflow: visible;
}

.player-position.rank-3.local-player {
 background: linear-gradient(135deg, #cd7f320%, #e89b5e100%);
 border:2px solid #4a9eff;
 color: #1a1a1a;
 box-shadow:
0016px rgba(74,158,255,0.8),
008px rgba(205,127,50,0.5),
02px4px rgba(0,0,0,0.3);
}

.class-icon {
 width:40px;
 height:40px;
 border-radius: var(--radius-sm);
 object-fit: cover;
 border:1px solid var(--border);
 opacity:0.9;
 flex-shrink:0;
}

.player-details {
 display: flex;
 flex-direction: column;
 gap:1px;
 flex-shrink:0;
}

.player-name {
 font-size:12px;
 font-weight:600;
 color: var(--text-primary);
 overflow: hidden;
 text-overflow: ellipsis;
 white-space: nowrap;
}

.hp-bar {
 position: relative;
 width:120px;
 height:18px;
 background: rgba(0,0,0,0.5);
 border-radius:2px;
 overflow: hidden;
 border:1px solid rgba(0,0,0,0.3);
}

.hp-fill {
 position: absolute;
 left:0;
 top:0;
 height:100%;
 transition:
 width0.3s ease,
 background0.3s ease;
 border-radius:2px;
 box-shadow: inset01px2px rgba(255,255,255,0.2);
}

.hp-text {
 position: absolute;
 left:50%;
 top:50%;
 transform: translate(-50%, -50%);
 font-size:9px;
 font-weight:700;
 color: var(--text-primary);
 text-shadow:
004px rgba(0,0,0,1),
01px3px rgba(0,0,0,1),
1px1px2px rgba(0,0,0,0.8);
 z-index:1;
 letter-spacing:0.3px;
}

.player-stats-main {
 display: flex;
 align-items: center;
 justify-content: flex-end;
 padding-right:2em;
 overflow: visible;
}

.stat {
 display: flex;
 flex-direction: column;
 align-items: center;
 gap: var(--gap-md);
 min-width:45px;
 flex:00 auto;
}

.stat-label {
 font-size:7px;
 font-weight:600;
 text-transform: uppercase;
 letter-spacing:0.1px;
 color: var(--text-secondary);
 white-space: nowrap;
}

.stat-value {
 font-size:10px;
 font-weight:700;
 color: var(--text-primary);
 white-space: nowrap;
 overflow: visible;
}

.expandable-stats {
 display: none;
 margin-top: var(--gap-xs);
 padding-top: var(--gap-xs);
 border-top:1px solid var(--border);
 gap: var(--gap-md);
 position: relative;
 z-index:1;
}

.expandable-stats.expanded {
 display: flex;
 flex-wrap: nowrap;
 animation: fadeIn0.3s ease;
 justify-content: flex-start;
}

@keyframes fadeIn {
 from {
 opacity:0;
 transform: translateY(-8px);
 }

 to {
 opacity:1;
 transform: translateY(0);
 }
}

.stat-group {
 display: flex;
 flex-direction: column;
 gap:1px;
 min-width:60px;
 align-items: center;
}

.stat-group-label {
 font-size:7px;
 font-weight:600;
 text-transform: uppercase;
 letter-spacing:0.1px;
 color: var(--text-secondary);
}

.stat-group-value {
 font-size:10px;
 font-weight:700;
 color: var(--accent-primary);
}

::-webkit-scrollbar {
 width:6px;
}

::-webkit-scrollbar-track {
 background: rgba(255,255,255,0.02);
}

::-webkit-scrollbar-thumb {
 background: rgba(74,158,255,0.3);
 border-radius:3px;
}

::-webkit-scrollbar-thumb:hover {
 background: rgba(74,158,255,0.5);
}

.dps-meter-container {
 max-width:100%;
 max-height: calc(500px * var(--scale));
 overflow-y: auto;
 overflow-x: hidden;
}

/* Skills View Styles */
.skills-container {
 min-width: calc(550px * var(--scale));
 max-height: calc(500px * var(--scale));
 overflow-y: auto;
 overflow-x: hidden;
 background: var(--bg-darker);
 border-radius: var(--radius);
 border:1px solid var(--border);
 pointer-events: auto;
}

.skills-message {
 text-align: center;
 padding:20px;
 color: var(--text-secondary);
 font-size:14px;
 background: var(--bg-darker);
 border-radius: var(--radius);
 border:1px solid var(--border);
 pointer-events: auto;
}

.player-skill-section {
 margin-bottom:16px;
 background: rgba(255,255,255,0.02);
 border-radius: var(--radius);
 border:1px solid var(--border);
 overflow: hidden;
 pointer-events: auto;
}

.player-skill-header {
 display: flex;
 align-items: center;
 gap: var(--gap-lg);
 padding: var(--gap-lg);
 background: var(--bg-light);
 border-bottom:1px solid var(--border);
}

.player-skill-header .class-icon {
 width:24px;
 height:24px;
}

.player-skill-header .player-name {
 font-size:14px;
 font-weight:600;
 color: var(--text-primary);
}

.player-skill-header .player-profession {
 font-size:11px;
 color: var(--text-secondary);
}

.skills-grid {
 display: grid;
 grid-template-columns: repeat(auto-fit, minmax(280px,1fr));
 gap: var(--gap-lg);
 padding: var(--gap-lg);
}

.skill-card {
 background: rgba(255,255,255,0.03);
 border:1px solid var(--border);
 border-radius: var(--radius);
 padding: var(--gap-lg);
 transition: all var(--transition);
}

.skill-card:hover {
 background: rgba(255,255,255,0.05);
 border-color: var(--border-hover);
}

.skill-header {
 display: flex;
 justify-content: space-between;
 align-items: center;
 margin-bottom: var(--gap-lg);
}

.skill-name {
 font-size:13px;
 font-weight:600;
 color: var(--text-primary);
}

.skill-type {
 font-size:9px;
 font-weight:700;
 text-transform: uppercase;
 padding:2px6px;
 border-radius: var(--radius-sm);
 letter-spacing:0.5px;
}

.skill-type.damage {
 background: rgba(220,53,69,0.2);
 color: #ff6b7a;
 border:1px solid rgba(220,53,69,0.3);
}

.skill-type.healing {
 background: rgba(40,167,69,0.2);
 color: #5fc27e;
 border:1px solid rgba(40,167,69,0.3);
}

.skill-stats {
 display: grid;
 grid-template-columns: repeat(2, minmax(0,1fr));
 gap: var(--gap-md);
}

.skill-stat {
 display: flex;
 justify-content: space-between;
 align-items: center;
}

.skill-stat-label {
 font-size:10px;
 color: var(--text-secondary);
 text-transform: uppercase;
 letter-spacing:0.3px;
}

.skill-stat-value {
 font-size:11px;
 font-weight:600;
 color: var(--text-primary);
}

@media (max-width:768px) {
 .dps-meter {
 padding: var(--gap-sm);
 }

 .player-stats {
 gap: var(--gap-sm);
 }

 .stat-value {
 font-size:11px;
 }

 .skills-container {
 max-width:100%;
 max-height:500px;
 }

 .skills-grid {
 grid-template-columns:1fr;
 }

 .skill-stats {
 grid-template-columns:1fr;
 }
}

.group-toggle {
 margin-bottom: var(--gap-lg);
 padding: var(--gap-lg);
 background: rgba(255,255,255,0.03);
 border:1px solid var(--border);
 border-radius: var(--radius);
}

.group-toggle label {
 display: flex;
 align-items: center;
 gap: var(--gap-md);
 cursor: pointer;
 font-size:13px;
 color: var(--text-primary);
}

.group-toggle input[type="checkbox"] {
 width:18px;
 height:18px;
 cursor: pointer;
}

.group-info {
 margin-bottom: var(--gap-lg);
}

.group-info p {
 margin:0;
 font-size:11px;
 color: var(--text-secondary);
}

.group-members,
.available-players {
 margin-bottom: var(--gap-lg);
}

.group-members h4,
.available-players h4 {
 margin:00 var(--gap-md)0;
 font-size:12px;
 font-weight:600;
 color: var(--text-primary);
 text-transform: uppercase;
 letter-spacing:0.5px;
}

#group-members-list,
#available-players-list {
 display: flex;
 flex-direction: column;
 gap: var(--gap-sm);
 max-height:200px;
 overflow-y: auto;
}

.group-member-item,
.available-player-item {
 display: flex;
 align-items: center;
 justify-content: space-between;
 padding: var(--gap-md);
 background: rgba(255,255,255,0.03);
 border:1px solid var(--border);
 border-radius: var(--radius);
 font-size:12px;
 color: var(--text-primary);
}

.available-player-item {
 cursor: pointer;
 transition: all var(--transition);
}

.available-player-item:hover {
 background: rgba(255,255,255,0.08);
 border-color: var(--border-hover);
}

.player-item-info {
 display: flex;
 align-items: center;
 gap: var(--gap-md);
}

.player-item-icon {
 width:20px;
 height:20px;
}

.player-item-name {
 font-weight:600;
}

.player-item-remove {
 background: rgba(220,53,69,0.2);
 border:1px solid rgba(220,53,69,0.3);
 color: #ff6b7a;
 padding:4px8px;
 border-radius: var(--radius-sm);
 font-size:10px;
 font-weight:600;
 cursor: pointer;
 transition: all var(--transition);
}

.player-item-remove:hover {
 background: rgba(220,53,69,0.3);
}

.group-actions {
 margin-bottom: var(--gap-lg);
}

.btn-clear-group {
 width:100%;
 padding: var(--gap-md);
 background: rgba(220,53,69,0.2);
 border:1px solid rgba(220,53,69,0.3);
 color: #ff6b7a;
 border-radius: var(--radius);
 cursor: pointer;
 font-size:11px;
 font-weight:600;
 transition: all var(--transition);
}

.btn-clear-group:hover {
 background: rgba(220,53,69,0.3);
}

#group-btn.active {
 background: rgba(74,158,255,0.3);
 border-color: var(--accent-primary);
}

/* History Window Styles */
.history-window {
 min-width: calc(1200px * var(--scale));
 height: calc(800px * var(--scale));
 display: flex;
 flex-direction: column;
 position: relative;
}
.history-window::before {
 content: "";
 position: absolute;
 inset:0;
 background: var(--bg-dark);
 border-radius: var(--radius);
 border:1px solid var(--border);
 backdrop-filter: blur(8px);
 opacity:1;
 pointer-events: none;
 z-index:0;
}
.history-window > * {
 position: relative;
 z-index:1;
}

.history-window .controls {
 flex-shrink:0;
 background: var(--bg-darker);
 border-radius: var(--radius);
 border:1px solid var(--border);
}

.history-window .drag-indicator {
 cursor: grab;
 pointer-events: auto;
}

.history-window .drag-indicator:active {
 cursor: grabbing;
}

.history-container {
 display: flex;
 flex:1;
 overflow: hidden;
 background: var(--bg-dark);
}

.history-list-section {
 width:320px;
 border-right:1px solid var(--border);
 display: flex;
 flex-direction: column;
 background: rgba(0,0,0,0.2);
 pointer-events: auto;
}

.history-header {
 display: flex;
 gap: var(--gap-md);
 padding: var(--gap-lg);
 border-bottom:1px solid var(--border);
}

.history-header button {
 flex:1;
 font-size:11px;
 pointer-events: auto;
}

.history-header button.enabled {
 background: rgba(40,167,69,0.2);
 border-color: rgba(40,167,69,0.3);
 color: #5fc27e;
}

.history-list {
 flex:1;
 overflow-y: auto;
 padding: var(--gap-md);
}

.history-item {
 background: rgba(255,255,255,0.02);
 border:1px solid var(--border);
 border-radius: var(--radius);
 padding: var(--gap-lg);
 margin-bottom: var(--gap-md);
 cursor: pointer;
 transition: all var(--transition);
 pointer-events: auto;
}

.history-item:hover {
 background: rgba(255,255,255,0.05);
 border-color: var(--border-hover);
}

.history-item.active {
 background: rgba(108,99,255,0.1);
 border-color: var(--primary);
}

.history-item-header {
 display: flex;
 align-items: center;
 gap: var(--gap-md);
 margin-bottom: var(--gap-md);
}

.history-date {
 font-size:12px;
 font-weight:600;
 color: var(--text-primary);
}

.history-item-stats {
 display: flex;
 flex-direction: column;
 gap: 6px;
}

.history-stat {
 display: flex;
 align-items: center;
 gap: 8px;
 font-size:11px;
 color: var(--text-secondary);
}

.history-stat i {
 width:14px;
 text-align: center;
 opacity:0.6;
}

.history-details-section {
 flex:1;
 display: flex;
 flex-direction: column;
 overflow: hidden;
 pointer-events: auto;
}

.history-details {
 flex:1;
 overflow-y: auto;
 padding: var(--gap-lg);
}

.history-details-header {
 margin-bottom: var(--gap-xl);
}

.history-details-header h4 {
 font-size:18px;
 color: var(--text-primary);
 margin:00 var(--gap-lg)0;
}

.history-details-meta {
 display: flex;
 gap: var(--gap-xl);
 margin-bottom: var(--gap-lg);
}

.meta-item {
 display: flex;
 align-items: center;
 gap: var(--gap-md);
 font-size:12px;
 color: var(--text-secondary);
}

.meta-item i {
 opacity:0.6;
}

.history-actions {
 display: flex;
 gap: var(--gap-md);
}

.history-player-list {
 display: flex;
 flex-direction: column;
 gap: var(--gap-md);
}

.history-player-item {
 display: flex;
 align-items: center;
 gap: var(--gap-lg);
 background: rgba(255,255,255,0.02);
 border:1px solid var(--border);
 border-radius: var(--radius);
 padding: var(--gap-lg);
 transition: all var(--transition);
}

.history-player-item:hover {
 background: rgba(255,255,255,0.05);
 border-color: var(--border-hover);
}

/* Group Window Styles */
.group-meter {
 width:100%;
 height:100%;
 background: var(--bg-dark);
 backdrop-filter: blur(8px);
 padding:1px;
 display: flex;
 flex-direction: column;
 gap:1px;
 border-radius: var(--radius);
 box-sizing: border-box;
 overflow: hidden;
 position: relative;
}

.group-header {
 display: flex;
 align-items: center;
 gap: var(--gap-sm);
 padding: var(--gap-xs);
 background: var(--bg-darker);
 border-radius: var(--radius);
 border:1px solid var(--border);
 -webkit-app-region: no-drag;
}

.drag-indicator {
 width:24px;
 height:24px;
 background: rgba(255,255,255,0.05);
 border:1px solid var(--border);
 border-radius: var(--radius-sm);
 color: var(--text-secondary);
 cursor: move;
 display: flex;
 align-items: center;
 justify-content: center;
 transition: all var(--transition);
 font-size:10px;
}

.drag-indicator:hover {
 background: var(--accent-primary);
 color: var(--text-primary);
 border-color: var(--accent-primary);
}

.group-title {
 padding:4px8px;
 font-size:11px;
 font-weight:600;
 color: var(--text-primary);
 text-transform: uppercase;
 letter-spacing:0.5px;
}

.group-window {
 padding: var(--gap-lg);
 background: var(--bg-darker);
 border-radius: var(--radius);
 border:1px solid var(--border);
 overflow-y: auto;
 overflow-x: hidden;
 flex:11 auto;
 min-height:0;
 pointer-events: auto;
}

.group-window * {
 pointer-events: auto;
}

.group-toggle {
 margin-bottom: var(--gap-lg);
 padding: var(--gap-md);
 background: rgba(255,255,255,0.03);
 border:1px solid var(--border);
 border-radius: var(--radius);
 transition: all var(--transition);
}

.group-toggle:hover {
 background: rgba(255,255,255,0.05);
 border-color: var(--border-hover);
}

.group-toggle label {
 display: flex;
 align-items: center;
 gap: var(--gap-md);
 cursor: pointer;
 font-size:13px;
 font-weight:500;
}

.group-toggle input[type="checkbox"] {
 width:18px;
 height:18px;
 cursor: pointer;
 accent-color: var(--accent-primary);
}

.group-info {
 margin-bottom: var(--gap-lg);
}

.group-info p {
 margin:0;
 font-size:12px;
 color: var(--text-secondary);
}

.group-section {
 margin-bottom: var(--gap-lg);
}

.group-section h4 {
 margin:00 var(--gap-md)0;
 font-size:12px;
 font-weight:600;
 color: var(--text-secondary);
 text-transform: uppercase;
 letter-spacing:0.5px;
}

.group-members-list,
.available-players-list {
 max-height: calc(250px * var(--scale));
 overflow-y: auto;
 border:1px solid var(--border);
 border-radius: var(--radius);
 background: rgba(255,255,255,0.02);
 backdrop-filter: blur(4px);
}

.group-member-item,
.available-player-item {
 display: flex;
 justify-content: space-between;
 align-items: center;
 padding: var(--gap-md) var(--gap-lg);
 border-bottom:1px solid var(--border);
 transition: all var(--transition);
}

.group-member-item:last-child,
.available-player-item:last-child {
 border-bottom: none;
}

.available-player-item {
 cursor: pointer;
}

.available-player-item:hover {
 background: rgba(74,158,255,0.1);
 border-left:2px solid var(--accent-primary);
 padding-left: calc(var(--gap-lg) -2px);
}

.player-info {
 display: flex;
 align-items: center;
 gap: var(--gap-sm);
 flex:1;
}

.player-name {
 font-size:12px;
 color: var(--text-primary);
 font-weight:500;
}

.player-uid {
 font-size:10px;
 color: var(--text-muted);
 font-weight:400;
}

.player-profession {
 font-size:10px;
 color: var(--text-secondary);
 padding:2px6px;
 background: rgba(255,255,255,0.05);
 border-radius: var(--radius-sm);
 border:1px solid var(--border);
}

.btn-remove {
 background: rgba(239,68,68,0.15);
 border:1px solid rgba(239,68,68,0.3);
 color: #ef4444;
 padding:4px12px;
 border-radius: var(--radius-sm);
 cursor: pointer;
 font-size:10px;
 font-weight:600;
 text-transform: uppercase;
 letter-spacing:0.5px;
 transition: all var(--transition);
}

.btn-remove:hover {
 background: rgba(239,68,68,0.25);
 border-color: rgba(239,68,68,0.5);
}

.btn-clear-group {
 width:100%;
 padding: var(--gap-md) var(--gap-lg);
 background: rgba(239,68,68,0.15);
 border:1px solid rgba(239,68,68,0.3);
 color: #ef4444;
 border-radius: var(--radius);
 cursor: pointer;
 font-size:11px;
 font-weight:600;
 text-transform: uppercase;
 letter-spacing:0.5px;
 transition: all var(--transition);
}

.btn-clear-group:hover {
 background: rgba(239,68,68,0.25);
 border-color: rgba(239,68,68,0.5);
}

.empty-state {
 padding: var(--gap-lg);
 text-align: center;
 color: var(--text-muted);
 font-size:11px;
 font-style: italic;
}

.group-actions {
 margin-bottom: var(--gap-lg);
}

.registry-controls {
 display: flex;
 gap: var(--gap-md);
 margin-top: var(--gap-md);
}

/* Custom scrollbar */
.group-members-list::-webkit-scrollbar,
.available-players-list::-webkit-scrollbar,
.group-window::-webkit-scrollbar {
 width:6px;
}

.group-members-list::-webkit-scrollbar-track,
.available-players-list::-webkit-scrollbar-track,
.group-window::-webkit-scrollbar-track {
 background: transparent;
}

.group-members-list::-webkit-scrollbar-thumb,
.available-players-list::-webkit-scrollbar-thumb,
.group-window::-webkit-scrollbar-thumb {
 background: rgba(255,255,255,0.1);
 border-radius:3px;
}

.group-members-list::-webkit-scrollbar-thumb:hover,
.available-players-list::-webkit-scrollbar-thumb:hover,
.group-window::-webkit-scrollbar-thumb:hover {
 background: rgba(255,255,255,0.15);
}

.player-rank {
 font-size:18px;
 font-weight:700;
 color: var(--primary);
 width:40px;
 text-align: center;
}

.player-info {
 flex:1;
}

.player-info .player-name {
 font-size:14px;
 font-weight:600;
 color: var(--text-primary);
 margin-bottom:4px;
}

.player-info .player-profession {
 font-size:11px;
 color: var(--text-secondary);
}

.player-stats {
 display: flex;
 gap:14px;
}

.player-stat {
 display: flex;
 flex-direction: column;
 align-items: flex-end;
 gap: var(--gap-lg);
}

.player-stat .stat-label {
 font-size:10px;
 color: var(--text-secondary);
 text-transform: uppercase;
 letter-spacing:0.5px;
 margin-bottom:4px;
}

.player-stat .stat-value {
 font-size:14px;
 font-weight:600;
 color: var(--text-primary);
}

.view-skills-btn {
 background: rgba(108,99,255,0.1);
 border:1px solid rgba(108,99,255,0.3);
 color: var(--primary);
 padding:8px12px;
 border-radius: var(--radius);
 cursor: pointer;
 transition: all var(--transition);
 pointer-events: auto;
}

.view-skills-btn:hover {
 background: rgba(108,99,255,0.2);
 border-color: var(--primary);
}

.empty-state {
 display: flex;
 flex-direction: column;
 align-items: center;
 justify-content: center;
 padding: var(--gap-xl);
 color: var(--text-secondary);
 text-align: center;
 min-height:200px;
}

.empty-state p {
 margin:4px0;
}

.loading-indicator {
 display: flex;
 flex-direction: column;
 align-items: center;
 justify-content: center;
 padding: var(--gap-xl);
 color: var(--text-secondary);
 gap: var(--gap-lg);
 min-height:200px;
}

/* Modal styles */
.modal {
 display: none;
 position: fixed;
 top:0;
 left:0;
 width:100%;
 height:100%;
 background: rgba(0,0,0,0.8);
 align-items: center;
 justify-content: center;
 z-index:1000;
 pointer-events: auto;
}

.modal-content {
 background: var(--bg-dark);
 border:1px solid var(--border);
 border-radius: var(--radius);
 width:90%;
 max-width:700px;
 max-height:80vh;
 height: auto;
 display: flex;
 flex-direction: column;
 box-shadow:04px20px rgba(0,0,0,0.5);
 overflow: hidden;
}

.modal-header {
 display: flex;
 align-items: center;
 justify-content: space-between;
 padding: var(--gap-lg);
 border-bottom:1px solid var(--border);
 pointer-events: auto;
 flex-shrink:0;
}

.modal-header h3 {
 margin:0;
 font-size:16px;
 color: var(--text-primary);
}

.modal-body {
 flex:1;
 overflow-y: auto;
 overflow-x: hidden;
 padding: var(--gap-lg);
 pointer-events: auto;
 min-height:0;
}

.skill-list {
 display: flex;
 flex-direction: column;
 gap: var(--gap-md);
}

.skill-item {
 background: rgba(255,255,255,0.02);
 border:1px solid var(--border);
 border-radius: var(--radius);
 padding: var(--gap-lg);
 transition: all var(--transition);
}

.skill-item:hover {
 background: rgba(255,255,255,0.05);
 border-color: var(--border-hover);
}

.skill-header {
 display: flex;
 justify-content: space-between;
 align-items: center;
 margin-bottom: var(--gap-md);
}

.skill-name {
 font-size:14px;
 font-weight:600;
 color: var(--text-primary);
}

.skill-damage {
 font-size:14px;
 font-weight:700;
 color: var(--primary);
}

.skill-details {
 display: flex;
 gap: var(--gap-xl);
 margin-bottom: var(--gap-md);
}

.skill-detail {
 display: flex;
 gap:4px;
}

.skill-detail .detail-label {
 font-size:11px;
 color: var(--text-secondary);
}

.skill-detail .detail-value {
 font-size:11px;
 font-weight:600;
 color: var(--text-primary);
}

.skill-progress {
 width:100%;
 height:4px;
 background: rgba(255,255,255,0.05);
 border-radius:2px;
 overflow: hidden;
}

.skill-progress .progress-bar {
 height:100%;
 background: linear-gradient(90deg, var(--primary), rgba(108,99,255,0.6));
 transition: width0.3s ease;
}

/* Transparency enforcement and correct background layering */
html, body { background: transparent !important; }
.dps-meter { background: transparent !important; }
.dps-bg { opacity: var(--content-opacity) !important; }
.dps-meter > :not(.controls):not(.dps-bg) { opacity: var(--content-opacity) !important; }
.controls { opacity:1 !important; }
/* Ensure content wrappers don’t bring their own background when opacity is0 */
.skills-container, .skills-message, .player-bar, .history-container {
 background-color: rgba(0,0,0,0.0);
}

/* Settings window styling parity */
.settings-app {
 width:560px;
 background: linear-gradient(180deg, rgba(8,12,18,0.85), rgba(6,8,12,0.9));
 border:1px solid rgba(255,255,255,0.06);
 padding:18px;
 border-radius:10px;
 box-shadow:08px30px rgba(0,0,0,0.6), inset01px0 rgba(255,255,255,0.02);
 color: var(--text-primary);
 pointer-events: all;
 backdrop-filter: blur(6px) saturate(120%);
}

.settings-app .group-window { 
 background: rgba(255,255,255,0.02);
 border-radius: var(--radius);
 border:1px solid var(--border);
 padding:12px;
 margin-top:12px;
}

.settings-app .group-title {
 font-weight:700;
 color: var(--text-primary);
 font-size:13px;
}

/* History window glass background to match group window */
.history-window { position: relative; }
.history-window::before {
 content: "";
 position: absolute;
 inset:0;
 background: var(--bg-dark);
 border-radius: var(--radius);
 border:1px solid var(--border);
 backdrop-filter: blur(8px);
 opacity:1;
 pointer-events: none;
 z-index:0;
}
.history-window > * { position: relative; z-index:1; }
/* Ensure the history header matches the control bar style */
.history-window .controls { background: var(--bg-darker); border-radius: var(--radius); border:1px solid var(--border); }
